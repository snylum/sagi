:root{
  --bg:#f7fafc; --card:#ffffff; --muted:#6b7280; --accent:#0ea5a4;
  --book-width:360px; --book-height:480px;
  --page-width:320px; --page-height:460px;
  --shadow: rgba(2,6,23,0.12);
}

*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial;color:#0f172a;background:var(--bg)}
a{color:inherit}

.container{max-width:960px;margin:2rem auto;padding:1rem}
.top{display:flex;align-items:baseline;gap:1rem}
.muted{color:var(--muted);font-size:.95rem}

.shelf-grid{
  display:grid;
  grid-template-columns: repeat(auto-fill,minmax(120px,1fr));
  gap:1rem;
  padding:1rem;
  max-width:1100px;
  margin:1rem auto;
}

/* Book tile (spine) */
.book-tile{
  perspective:1200px;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  height:220px;
}
.book-tile .spine{
  width:100px;
  height:200px;
  border-radius:6px;
  object-fit:cover;
  box-shadow: 0 6px 18px var(--shadow);
  transition: transform .45s cubic-bezier(.2,.9,.2,1), box-shadow .45s;
  transform-origin:center;
}
.book-tile:hover .spine{ transform: translateY(-8px) rotateY(-8deg); box-shadow: 0 14px 32px rgba(2,6,23,0.2) }

/* Reader root */
.reader-root{ position:fixed; inset:0; display:flex; flex-direction:column; align-items:center; justify-content:center; z-index:60; pointer-events:auto }
.reader-root.hidden{ display:none }

.overlay{ position:fixed; inset:0; background:rgba(2,6,23,0.3); z-index:50; transition:opacity .35s; }
.overlay.hidden{ display:none }

.book-scene{ width:var(--book-width); height:var(--book-height); perspective:1400px; display:flex; align-items:center; justify-content:center; margin-bottom:1rem; }
.book{
  width:var(--book-width);
  height:var(--book-height);
  position:relative;
  transform-style:preserve-3d;
  transition: transform .8s cubic-bezier(.2,.9,.2,1);
}
.book.opening{ transform: translateY(-24px) rotateY(-18deg) scale(1.02); box-shadow: 0 30px 60px rgba(2,6,23,0.25); }

.cover{
  position:absolute;
  width:100%;
  height:100%;
  background:linear-gradient(180deg,#fff,#f3f7f9);
  border-radius:6px;
  backface-visibility:hidden;
  box-shadow: 0 8px 18px rgba(2,6,23,0.12);
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
  transform-origin:left center;
}

/* front cover sits above pages initially */
.cover.front{
  z-index:40;
  transform-origin:left center;
  background: linear-gradient(180deg,#ffffff,#f8fafc);
}

/* back cover is behind */
.cover.back{
  transform: rotateY(180deg);
  z-index:0;
  background: linear-gradient(180deg,#fafafa,#ffffff);
}

/* Pages container */
.pages{
  position:absolute;
  left:12px;
  top:10px;
  width: calc(var(--book-width) - 24px);
  height: calc(var(--book-height) - 20px);
  transform-style:preserve-3d;
  z-index:20;
  pointer-events:none;
}

/* Single page */
.page {
  position:absolute;
  left:0;
  top:0;
  width:100%;
  height:100%;
  background: #fff;
  border-radius:4px;
  box-shadow: 2px 6px 18px rgba(2,6,23,0.08);
  transform-origin:left center;
  transform-style:preserve-3d;
  backface-visibility:hidden;
  overflow:auto;
  padding:24px;
  font-size:0.975rem;
  line-height:1.6;
}

/* flipped state rotates page out */
.page.flipped {
  transform: rotateY(-180deg);
  box-shadow: none;
}

/* sub-page style for right-side */
.page.right {
  right:0;
  left:auto;
  transform-origin:right center;
}

/* content typography inside pages */
.page h1, .page h2, .page h3 { margin: 0 0 .6rem 0; }
.page p { margin: 0 0 1rem 0; white-space:pre-wrap; }

/* Reader nav */
.reader-nav {
  display:flex;
  gap:0.75rem;
  align-items:center;
}
.reader-nav button{
  border-radius:10px;border:1px solid #e6eef0;background:#fff;padding:.5rem .8rem;
  box-shadow: 0 4px 12px rgba(2,6,23,0.06); cursor:pointer; transition:transform .2s;
}
.reader-nav button:hover{ transform: translateY(-3px) }

/* Table of contents panel */
.toc{
  position:fixed;
  right:3rem;
  top:4rem;
  width:260px;
  max-height:70vh;
  overflow:auto;
  background:var(--card);
  border-radius:10px;
  padding:12px;
  box-shadow: 0 12px 34px rgba(2,6,23,0.12);
}
.toc.hidden{ display:none }
.toc ul{ list-style:none;padding:0;margin:0 }
.toc li{ margin:8px 0 }

/* small/safe responsive */
@media (max-width:700px){
  :root{ --book-width:320px; --book-height:420px }
  .toc{ display:none }
  .shelf-grid{ grid-template-columns: repeat(auto-fill,minmax(100px,1fr)) }
}
